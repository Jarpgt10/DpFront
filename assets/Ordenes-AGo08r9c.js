import{a as ce,c as de,r as M,A as ue,O as ae,P as le,j as e,I as C,i as he,k as fe,l as me}from"./index-TycLOtu4.js";import{I as re,F as ee,B as xe,s as R}from"./index-zPM6drAd.js";import{T as ie,R as ne,S as te,M as ge}from"./Table-BL5WxJO8.js";var oe={exports:{}};(function(S,L){(function(E,v){S.exports=v()})(de,function(){var E=1e3,v=6e4,A=36e5,k="millisecond",$="second",g="minute",y="hour",b="day",I="week",x="month",T="quarter",_="year",D="date",Y="Invalid Date",F=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Q=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,B={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var n=["th","st","nd","rd"],t=i%100;return"["+i+(n[(t-20)%10]||n[t]||n[0])+"]"}},u=function(i,n,t){var a=String(i);return!a||a.length>=n?i:""+Array(n+1-a.length).join(t)+i},H={s:u,z:function(i){var n=-i.utcOffset(),t=Math.abs(n),a=Math.floor(t/60),r=t%60;return(n<=0?"+":"-")+u(a,2,"0")+":"+u(r,2,"0")},m:function i(n,t){if(n.date()<t.date())return-i(t,n);var a=12*(t.year()-n.year())+(t.month()-n.month()),r=n.clone().add(a,x),o=t-r<0,c=n.clone().add(a+(o?-1:1),x);return+(-(a+(t-r)/(o?r-c:c-r))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:x,y:_,w:I,d:b,D,h:y,m:g,s:$,ms:k,Q:T}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},N="en",z={};z[N]=B;var K="$isDayjsObject",J=function(i){return i instanceof d||!(!i||!i[K])},q=function i(n,t,a){var r;if(!n)return N;if(typeof n=="string"){var o=n.toLowerCase();z[o]&&(r=o),t&&(z[o]=t,r=o);var c=n.split("-");if(!r&&c.length>1)return i(c[0])}else{var l=n.name;z[l]=n,r=l}return!a&&r&&(N=r),r||!a&&N},f=function(i,n){if(J(i))return i.clone();var t=typeof n=="object"?n:{};return t.date=i,t.args=arguments,new d(t)},s=H;s.l=q,s.i=J,s.w=function(i,n){return f(i,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var d=function(){function i(t){this.$L=q(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[K]=!0}var n=i.prototype;return n.parse=function(t){this.$d=function(a){var r=a.date,o=a.utc;if(r===null)return new Date(NaN);if(s.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var c=r.match(F);if(c){var l=c[2]-1||0,h=(c[7]||"0").substring(0,3);return o?new Date(Date.UTC(c[1],l,c[3]||1,c[4]||0,c[5]||0,c[6]||0,h)):new Date(c[1],l,c[3]||1,c[4]||0,c[5]||0,c[6]||0,h)}}return new Date(r)}(t),this.init()},n.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},n.$utils=function(){return s},n.isValid=function(){return this.$d.toString()!==Y},n.isSame=function(t,a){var r=f(t);return this.startOf(a)<=r&&r<=this.endOf(a)},n.isAfter=function(t,a){return f(t)<this.startOf(a)},n.isBefore=function(t,a){return this.endOf(a)<f(t)},n.$g=function(t,a,r){return s.u(t)?this[a]:this.set(r,t)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(t,a){var r=this,o=!!s.u(a)||a,c=s.p(t),l=function(W,j){var P=s.w(r.$u?Date.UTC(r.$y,j,W):new Date(r.$y,j,W),r);return o?P:P.endOf(b)},h=function(W,j){return s.w(r.toDate()[W].apply(r.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(j)),r)},m=this.$W,p=this.$M,w=this.$D,G="set"+(this.$u?"UTC":"");switch(c){case _:return o?l(1,0):l(31,11);case x:return o?l(1,p):l(0,p+1);case I:var U=this.$locale().weekStart||0,V=(m<U?m+7:m)-U;return l(o?w-V:w+(6-V),p);case b:case D:return h(G+"Hours",0);case y:return h(G+"Minutes",1);case g:return h(G+"Seconds",2);case $:return h(G+"Milliseconds",3);default:return this.clone()}},n.endOf=function(t){return this.startOf(t,!1)},n.$set=function(t,a){var r,o=s.p(t),c="set"+(this.$u?"UTC":""),l=(r={},r[b]=c+"Date",r[D]=c+"Date",r[x]=c+"Month",r[_]=c+"FullYear",r[y]=c+"Hours",r[g]=c+"Minutes",r[$]=c+"Seconds",r[k]=c+"Milliseconds",r)[o],h=o===b?this.$D+(a-this.$W):a;if(o===x||o===_){var m=this.clone().set(D,1);m.$d[l](h),m.init(),this.$d=m.set(D,Math.min(this.$D,m.daysInMonth())).$d}else l&&this.$d[l](h);return this.init(),this},n.set=function(t,a){return this.clone().$set(t,a)},n.get=function(t){return this[s.p(t)]()},n.add=function(t,a){var r,o=this;t=Number(t);var c=s.p(a),l=function(p){var w=f(o);return s.w(w.date(w.date()+Math.round(p*t)),o)};if(c===x)return this.set(x,this.$M+t);if(c===_)return this.set(_,this.$y+t);if(c===b)return l(1);if(c===I)return l(7);var h=(r={},r[g]=v,r[y]=A,r[$]=E,r)[c]||1,m=this.$d.getTime()+t*h;return s.w(m,this)},n.subtract=function(t,a){return this.add(-1*t,a)},n.format=function(t){var a=this,r=this.$locale();if(!this.isValid())return r.invalidDate||Y;var o=t||"YYYY-MM-DDTHH:mm:ssZ",c=s.z(this),l=this.$H,h=this.$m,m=this.$M,p=r.weekdays,w=r.months,G=r.meridiem,U=function(j,P,Z,X){return j&&(j[P]||j(a,o))||Z[P].slice(0,X)},V=function(j){return s.s(l%12||12,j,"0")},W=G||function(j,P,Z){var X=j<12?"AM":"PM";return Z?X.toLowerCase():X};return o.replace(Q,function(j,P){return P||function(Z){switch(Z){case"YY":return String(a.$y).slice(-2);case"YYYY":return s.s(a.$y,4,"0");case"M":return m+1;case"MM":return s.s(m+1,2,"0");case"MMM":return U(r.monthsShort,m,w,3);case"MMMM":return U(w,m);case"D":return a.$D;case"DD":return s.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return U(r.weekdaysMin,a.$W,p,2);case"ddd":return U(r.weekdaysShort,a.$W,p,3);case"dddd":return p[a.$W];case"H":return String(l);case"HH":return s.s(l,2,"0");case"h":return V(1);case"hh":return V(2);case"a":return W(l,h,!0);case"A":return W(l,h,!1);case"m":return String(h);case"mm":return s.s(h,2,"0");case"s":return String(a.$s);case"ss":return s.s(a.$s,2,"0");case"SSS":return s.s(a.$ms,3,"0");case"Z":return c}return null}(j)||c.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(t,a,r){var o,c=this,l=s.p(a),h=f(t),m=(h.utcOffset()-this.utcOffset())*v,p=this-h,w=function(){return s.m(c,h)};switch(l){case _:o=w()/12;break;case x:o=w();break;case T:o=w()/3;break;case I:o=(p-m)/6048e5;break;case b:o=(p-m)/864e5;break;case y:o=p/A;break;case g:o=p/v;break;case $:o=p/E;break;default:o=p}return r?o:s.a(o)},n.daysInMonth=function(){return this.endOf(x).$D},n.$locale=function(){return z[this.$L]},n.locale=function(t,a){if(!t)return this.$L;var r=this.clone(),o=q(t,a,!0);return o&&(r.$L=o),r},n.clone=function(){return s.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},i}(),O=d.prototype;return f.prototype=O,[["$ms",k],["$s",$],["$m",g],["$H",y],["$W",b],["$M",x],["$y",_],["$D",D]].forEach(function(i){O[i[1]]=function(n){return this.$g(n,i[0],i[1])}}),f.extend=function(i,n){return i.$i||(i(n,d,f),i.$i=!0),f},f.locale=q,f.isDayjs=J,f.unix=function(i){return f(1e3*i)},f.en=z[N],f.Ls=z,f.p={},f})})(oe);var pe=oe.exports;const se=ce(pe);function $e({data:S,onClose:L}){const{session:E}=M.useContext(ue),{handleItemQuantity:v,isItemAdded:A,carrito:k,totalCarrito:$}=M.useContext(ae),{menu:g}=M.useContext(le),[y,b]=M.useState(""),[I,x]=M.useState(1),T=5,_=(I-1)*T,D=_+T,Y=M.useRef();M.useEffect(()=>{Y.current.resetFields()},[S]);const F=g.filter(u=>u.nombre_menu.toLowerCase().includes(y.toLowerCase())||u.precio.toLowerCase().includes(y.toLowerCase())),Q=F==null?void 0:F.slice(_,D),B=async u=>{const H={...u,carrito:k,total:$,direccion:u.direccion?u.direccion:"",id_orden:S&&S.id_orden?S.id_orden:0,id_usuario:E.id_usuario};await he(H).then(N=>{N.err?R.error(N.message):R.success(N.message)}).finally(()=>L())};return e.jsx("div",{className:"mt-5 p-5 bg-white rounded-lg shadow-lg h-[675px] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-gray-600 text-xl block mb-2",children:"Menú"}),e.jsx(re,{type:"text",placeholder:"Buscar por nombre de menú",className:"mb-4 border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200",onChange:u=>b(u.target.value)}),e.jsx(ie,{dataSource:Q,rowKey:"id_menu_comida",columns:[{title:"No.",dataIndex:"id_menu_comida",key:"id_menu_comida"},{title:"Menu",dataIndex:"nombre_menu",key:"nombre_menu"},{title:"Precio",dataIndex:"precio",key:"precio"},{title:"Opcion",render:u=>e.jsxs("div",{className:"flex gap-5",children:[e.jsx("button",{className:"hover:bg-gray-800 rounded-full hover:text-white",onClick:()=>v(u.id_menu_comida,"add",g),children:e.jsx(C.add,{size:25})}),A(u.id_menu_comida)&&e.jsx("button",{className:"hover:bg-gray-800 rounded-full hover:text-white",onClick:()=>v(u.id_menu_comida,"delete",g),children:e.jsx(C.delete,{size:25})})]})}],pagination:{onChange:u=>x(u),pageSize:T,current:I,total:(g==null?void 0:g.length)||0}})]}),e.jsx("div",{children:e.jsxs(ee,{layout:"vertical",ref:Y,onFinish:B,initialValues:S&&{titular:S.titular,comer_aqui:parseInt(S.comer_aqui),direccion:S.direccion},children:[e.jsx(ee.Item,{label:e.jsx("strong",{className:"text-gray-600 text-base block mb-2",children:"Nombre"}),name:"titular",rules:[{required:!0,message:"Ingrese Nombre"}],children:e.jsx(re,{className:"border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200"})}),e.jsx(ee.Item,{name:"comer_aqui",rules:[{required:!0,message:"ingrese Opcion"}],children:e.jsxs(ne.Group,{className:"flex-center gap-5 mb-4",children:[e.jsx(ne,{value:1,children:e.jsx(C.store,{size:30})}),e.jsx(ne,{value:0,children:e.jsx(C.truck,{size:30})})]})}),e.jsx(ee.Item,{label:e.jsx("strong",{className:"text-gray-600 text-base block mb-2",children:"Dirección"}),name:"direccion",children:e.jsx(re.TextArea,{className:"border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200"})}),e.jsx("strong",{className:"text-gray-400",children:"Seleccionado"}),k.length>0&&e.jsxs("div",{className:"mt-5 p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50",children:[k.map(u=>e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("strong",{children:u.nombre_menu}),e.jsxs("span",{className:"bg-[#1f2937] text-white py-1 px-2 rounded-md ",children:["x",u.cantidad]})]}),e.jsxs("span",{children:["GTQ ",u.precio*u.cantidad]})]},u.id_menu_comida)),e.jsx("div",{className:"flex justify-end mt-3 bg-gray-100 p-2 rounded-md",children:e.jsxs("strong",{children:["Total: GTQ ",$]})})]}),e.jsx("div",{className:"flex-end mt-2",children:e.jsx(xe,{className:"button-submit",type:"default",htmlType:"submit",children:"Guardar"})})]})})]})})}function be(){const{loading:S,orden:L,setCarrito:E,getAll:v,calculateTotal:A}=M.useContext(ae),[k,$]=M.useState(!1),[g,y]=M.useState(null),[b,I]=M.useState(1),x=5,T=(b-1)*x,_=T+x,[D,Y]=M.useState(""),[F,Q]=M.useState(null),B=s=>{Y(s.target.value)},u=s=>{Q(s)},H=L&&L.filter(s=>s.titular.toLowerCase().includes(D.toLowerCase())&&(F===null||parseInt(s.estado)===F)),N=H==null?void 0:H.slice(T,_),z=()=>{y(null),$(!1),E([]),A(0)},K=()=>{$(!1),y(null),v()},J=s=>{E(s.detalle_orden),A(s.detalle_orden),y(s),$(!0)},q=(s,d)=>{fe(s,d).then(O=>{O.err?R.error(O.message):R.success(O.message)}).finally(()=>v())},f=(s,d)=>{me(s,d).then(O=>{O.err?R.error(O.message):R.success(O.message)}).finally(()=>v())};return e.jsxs("div",{className:"h-screen px-[5%] py-[5%]",children:[e.jsx("div",{className:"title-1 flex-between",children:e.jsx("span",{children:"ORDENES"})}),e.jsxs("div",{className:"flex-between",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex-center gap-5",children:[e.jsx(C.reload,{size:25,onClick:()=>v(),className:"cursor-pointer"}),e.jsx(re.Search,{onChange:B}),e.jsxs(te,{placeholder:"Filtrar por estado",onChange:u,allowClear:!0,style:{width:200},children:[e.jsx(te.Option,{value:null,children:"Todos"}),e.jsx(te.Option,{value:0,children:"Preparando"}),e.jsx(te.Option,{value:1,children:"Entregado"})]}),e.jsx("button",{onClick:()=>$(!0),children:e.jsx(C.add,{size:25,color:"white",className:"bg-[#1f2937] bg-hover-3 rounded-full"})})]}),e.jsx("div",{})]}),e.jsx(ie,{className:"mt-5",dataSource:N,loading:S,rowKey:"id_orden",columns:[{title:"Orden",width:100,render:(s,d)=>e.jsx("div",{className:"bg-4 p-1 mx-auto text-xl text-1 rounded-lg flex-center items-center",children:e.jsx("strong",{children:d.id_orden})}),sorter:(s,d)=>s.id_orden-d.id_orden},{title:"Nombre",width:250,render:(s,d)=>e.jsx("div",{className:"",children:e.jsx("strong",{children:d.titular})})},{title:"Para",render:(s,d)=>e.jsx("div",{className:"",children:e.jsx("strong",{children:parseInt(d.comer_aqui)===1?e.jsx(C.store,{size:30}):e.jsx(C.truck,{size:30})})})},{title:"Fecha",dataIndex:"fecha_ingreso",key:"fecha_ingreso",sorter:(s,d)=>se(s.fecha_ingreso).unix()-se(d.fecha_ingreso).unix()},{title:"Total",render:(s,d)=>e.jsxs("div",{className:"",children:["GTQ ",e.jsx("strong",{children:d.total})]})},{title:"Estado",render:(s,d)=>e.jsx("div",{className:"",children:e.jsx("strong",{className:`${parseInt(d.estado)===1?"bg-green-700 ":"bg-orange-400"} text-white p-1 rounded-md hover:border-2 border-[#00000059] cursor-pointer`,onClick:()=>f(d.id_orden,parseInt(d.estado)===1?0:1),children:parseInt(d.estado)===1?"Entregado":"Preparando"})})},{title:"Pagado",render:(s,d)=>e.jsx("div",{className:"",children:e.jsx("strong",{className:`${parseInt(d.pagado)===1?"text-green-700":"text-red-800"} `,children:e.jsx("div",{className:"cursor-pointer",onClick:()=>q(d.id_orden,parseInt(d.pagado)===1?0:1),children:parseInt(d.pagado)===1?e.jsx(C.check,{size:25}):e.jsx(C.cancel,{size:25})})})})},{title:"Editar",render:(s,d)=>e.jsx("strong",{className:"cursor-pointer",onClick:()=>J(d),children:e.jsx(C.edit,{className:"hover:text-gray-500 ",size:20})})}],pagination:{onChange:s=>I(s),pageSize:x,current:b,total:(L==null?void 0:L.length)||0}}),e.jsx(ge,{open:k,footer:null,onCancel:()=>z(),title:e.jsxs("div",{children:[g?"Editar":"Crear"," Orden "]}),width:1200,centered:!0,children:e.jsx($e,{data:g,onClose:()=>K()})})]})}export{be as default};
