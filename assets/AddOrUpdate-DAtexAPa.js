import{r as a,A as F,f as k,j as e,F as N,B as O,ad as Y,P as R,ae as v}from"./index-BtNqoKqd.js";import{s as M,I as T}from"./index-CPZvfxh0.js";import{T as B,M as L}from"./Table-DMk4TdfE.js";function U({data:n,addOrUpdateFunction:r,formFields:h,onClose:i}){const{session:d}=a.useContext(F),o=a.useRef();o.current&&!n&&o.current.resetFields();const m={...n,fecha_vencimiento:n.fecha_vencimiento?k(n.fecha_vencimiento,"YYYY-MM-DD"):null};a.useEffect(()=>{o.current.resetFields()},[n]);const x=async s=>{const l={...n,...s,estado:s.estado?1:0,id_usuario:d&&d.id_usuario,fecha_vencimiento:s.fecha_vencimiento?Y(s.fecha_vencimiento):""};r(l).then(c=>{c.err?M.error(c.message):M.success(c.message)}).finally(()=>i())};return e.jsxs(N,{layout:"vertical",onFinish:x,ref:o,initialValues:n&&m,children:[h.map((s,l)=>e.jsx(N.Item,{label:s.label,name:s.name,rules:s.rules,valuePropName:s.valuePropName,children:s.component},l)),e.jsx("div",{className:"flex-end",children:e.jsx(O,{className:"button-submit",type:"default",htmlType:"submit",children:"Guardar"})})]})}function q({pageSize:n,object:r,columns:h,title:i,rowKey:d,addOrUpdateFunction:o,formFields:m,filterBy:x}){const{loading:s,getAll:l}=a.useContext(R),[c,u]=a.useState(!1),[g,f]=a.useState(null),[j,y]=a.useState(1),C=(j-1)*n,b=C+n,[S,_]=a.useState(""),w=()=>{f(null),u(!1)},P=()=>{u(!1),f(null),l()},A=t=>{f(t),u(!0)},E=t=>{_(t.target.value)},p=r&&r.filter(t=>t[x].toLowerCase().includes(S.toLowerCase())),I=p==null?void 0:p.slice(C,b);return e.jsxs("div",{className:"h-screen px-[5%] py-[5%]",children:[e.jsx("div",{className:"title-1 flex-between",children:e.jsx("span",{children:i})}),e.jsxs("div",{className:"flex-between",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex-center gap-5",children:[e.jsx(v.reload,{size:25,onClick:()=>l(),className:"cursor-pointer"}),e.jsx(T.Search,{onChange:E})," ",e.jsx("button",{onClick:()=>u(!0),children:e.jsx(v.add,{size:25,color:"white",className:"bg-[#1f2937] bg-hover-3 rounded-full"})})]}),e.jsx("div",{className:"bg-white rounded-md p-2 hover:bg-gray-200 cursor-pointer "})]}),e.jsx(B,{className:"mt-5",dataSource:I,loading:s,rowKey:d,columns:[...h,{title:"Editar",render:(t,D)=>e.jsx("strong",{className:"cursor-pointer",onClick:()=>A(D),children:e.jsx(v.edit,{className:"hover:text-gray-500 ",size:20})})}],pagination:{onChange:t=>y(t),pageSize:n,current:j,total:(r==null?void 0:r.length)||0}}),e.jsx(L,{open:c,footer:null,onCancel:()=>w(),title:e.jsxs("div",{children:[g?"Editar":"Crear"," ",i," "]}),width:300,centered:!0,children:e.jsx(U,{data:g,addOrUpdateFunction:o,formFields:m,onClose:()=>P()})})]})}export{q as A};
