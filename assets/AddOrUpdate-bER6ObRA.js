import{r as a,A as F,f as k,j as e,F as N,B as O,ad as Y,P as R,ae as h}from"./index-BHcsccWt.js";import{s as M,I as T}from"./index-CKklSKz3.js";import{T as z,M as B}from"./Table-BSw4Egfi.js";function L({data:n,addOrUpdateFunction:r,formFields:m,onClose:i}){const{session:d}=a.useContext(F),o=a.useRef();o.current&&!n&&o.current.resetFields();const x={...n,fecha_vencimiento:n.fecha_vencimiento?k(n.fecha_vencimiento,"YYYY-MM-DD"):null};a.useEffect(()=>{o.current.resetFields()},[n]);const f=async s=>{const l={...n,...s,estado:s.estado?1:0,id_usuario:d&&d.id_usuario,fecha_vencimiento:s.fecha_vencimiento?Y(s.fecha_vencimiento):""};r(l).then(c=>{c.err?M.error(c.message):M.success(c.message)}).finally(()=>i())};return e.jsxs(N,{layout:"vertical",onFinish:f,ref:o,initialValues:n&&x,children:[m.map((s,l)=>e.jsx(N.Item,{label:s.label,name:s.name,rules:s.rules,valuePropName:s.valuePropName,children:s.component},l)),e.jsx("div",{className:"flex-end",children:e.jsx(O,{className:"button-submit",type:"default",htmlType:"submit",children:"Guardar"})})]})}function q({pageSize:n,object:r,columns:m,title:i,rowKey:d,addOrUpdateFunction:o,formFields:x,filterBy:f}){const{loading:s,getAll:l}=a.useContext(R),[c,u]=a.useState(!1),[j,p]=a.useState(null),[v,y]=a.useState(1),C=(v-1)*n,b=C+n,[S,_]=a.useState(""),w=()=>{p(null),u(!1)},P=()=>{u(!1),p(null),l()},A=t=>{p(t),u(!0)},E=t=>{_(t.target.value)},g=r&&r.filter(t=>t[f].toLowerCase().includes(S.toLowerCase())),I=g==null?void 0:g.slice(C,b);return e.jsxs("div",{className:"h-screen px-[5%] py-[5%]",children:[e.jsx("div",{className:"title-1 flex-between",children:e.jsx("span",{children:i})}),e.jsxs("div",{className:"flex-between",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex-center gap-5",children:[e.jsx(h.reload,{size:25,onClick:()=>l(),className:"cursor-pointer"}),e.jsx(T.Search,{onChange:E})," ",e.jsx("button",{onClick:()=>u(!0),children:e.jsx(h.add,{size:25,color:"white",className:"bg-[#1f2937] bg-hover-3 rounded-full"})})]}),e.jsx("div",{className:"bg-white rounded-md p-2 hover:bg-gray-200 cursor-pointer ",children:e.jsx(h.excel,{color:"green",size:25})})]}),e.jsx(z,{className:"mt-5",dataSource:I,loading:s,rowKey:d,columns:[...m,{title:"Editar",render:(t,D)=>e.jsx("strong",{className:"cursor-pointer",onClick:()=>A(D),children:e.jsx(h.edit,{className:"hover:text-gray-500 ",size:20})})}],pagination:{onChange:t=>y(t),pageSize:n,current:v,total:(r==null?void 0:r.length)||0}}),e.jsx(B,{open:c,footer:null,onCancel:()=>w(),title:e.jsxs("div",{children:[j?"Editar":"Crear"," ",i," "]}),width:300,centered:!0,children:e.jsx(L,{data:j,addOrUpdateFunction:o,formFields:x,onClose:()=>P()})})]})}export{q as A};
