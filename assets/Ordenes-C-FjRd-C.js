import{r as a,A,O as M,P as F,j as e,I as n,i as L,k as R,l as G}from"./index-Cfx0EcpG.js";import{I,F as w,B as U,s as g}from"./index-BT02u3C5.js";import{T as E,R as P,M as D}from"./Table-Bj6wk0nM.js";function Q({data:d,onClose:o}){const{session:f}=a.useContext(A),{handleItemQuantity:l,isItemAdded:N,carrito:j,totalCarrito:c}=a.useContext(M),{menu:i}=a.useContext(F),[m,v]=a.useState(""),[y,b]=a.useState(1),h=5,_=(y-1)*h,S=_+h,C=a.useRef();a.useEffect(()=>{C.current.resetFields()},[d]);const u=i.filter(r=>r.nombre_menu.toLowerCase().includes(m.toLowerCase())||r.precio.toLowerCase().includes(m.toLowerCase())),k=u==null?void 0:u.slice(_,S),O=async r=>{const z={...r,carrito:j,total:c,direccion:r.direccion?r.direccion:"",id_orden:d&&d.id_orden?d.id_orden:0,id_usuario:f.id_usuario};await L(z).then(p=>{p.err?g.error(p.message):g.success(p.message)}).finally(()=>o())};return e.jsx("div",{className:"mt-5 p-5 bg-white rounded-lg shadow-lg h-[675px] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-gray-600 text-xl block mb-2",children:"Menú"}),e.jsx(I,{type:"text",placeholder:"Buscar por nombre de menú",className:"mb-4 border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200",onChange:r=>v(r.target.value)}),e.jsx(E,{dataSource:k,rowKey:"id_menu_comida",columns:[{title:"No.",dataIndex:"id_menu_comida",key:"id_menu_comida"},{title:"Menu",dataIndex:"nombre_menu",key:"nombre_menu"},{title:"Precio",dataIndex:"precio",key:"precio"},{title:"Opcion",render:r=>e.jsxs("div",{className:"flex gap-5",children:[e.jsx("button",{className:"hover:bg-gray-800 rounded-full hover:text-white",onClick:()=>l(r.id_menu_comida,"add",i),children:e.jsx(n.add,{size:25})}),N(r.id_menu_comida)&&e.jsx("button",{className:"hover:bg-gray-800 rounded-full hover:text-white",onClick:()=>l(r.id_menu_comida,"delete",i),children:e.jsx(n.delete,{size:25})})]})}],pagination:{onChange:r=>b(r),pageSize:h,current:y,total:(i==null?void 0:i.length)||0}})]}),e.jsx("div",{children:e.jsxs(w,{layout:"vertical",ref:C,onFinish:O,initialValues:d&&{titular:d.titular,comer_aqui:parseInt(d.comer_aqui),direccion:d.direccion},children:[e.jsx(w.Item,{label:e.jsx("strong",{className:"text-gray-600 text-base block mb-2",children:"Nombre"}),name:"titular",rules:[{required:!0,message:"Ingrese Nombre"}],children:e.jsx(I,{className:"border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200"})}),e.jsx(w.Item,{name:"comer_aqui",rules:[{required:!0,message:"ingrese Opcion"}],children:e.jsxs(P.Group,{className:"flex-center gap-5 mb-4",children:[e.jsx(P,{value:1,children:e.jsx(n.store,{size:30})}),e.jsx(P,{value:0,children:e.jsx(n.truck,{size:30})})]})}),e.jsx(w.Item,{label:e.jsx("strong",{className:"text-gray-600 text-base block mb-2",children:"Dirección"}),name:"direccion",children:e.jsx(I.TextArea,{className:"border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200"})}),e.jsx("strong",{className:"text-gray-400",children:"Seleccionado"}),j.length>0&&e.jsxs("div",{className:"mt-5 p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50",children:[j.map(r=>e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("strong",{children:r.nombre_menu}),e.jsxs("span",{className:"bg-[#1f2937] text-white py-1 px-2 rounded-md ",children:["x",r.cantidad]})]}),e.jsxs("span",{children:["GTQ ",r.precio*r.cantidad]})]},r.id_menu_comida)),e.jsx("div",{className:"flex justify-end mt-3 bg-gray-100 p-2 rounded-md",children:e.jsxs("strong",{children:["Total: GTQ ",c]})})]}),e.jsx("div",{className:"flex-end mt-2",children:e.jsx(U,{className:"button-submit",type:"default",htmlType:"submit",children:"Guardar"})})]})})]})})}function V(){const{loading:d,orden:o,setCarrito:f,getAll:l,calculateTotal:N}=a.useContext(M),[j,c]=a.useState(!1),[i,m]=a.useState(null),[v,y]=a.useState(1),b=10,h=(v-1)*b,_=h+b,[S,C]=a.useState(""),u=o&&o.filter(t=>t.titular.toLowerCase().includes(S.toLowerCase())),k=u==null?void 0:u.slice(h,_),O=t=>{C(t.target.value)},r=()=>{m(null),c(!1),f([]),N(0)},z=()=>{c(!1),m(null),l()},p=t=>{f(t.detalle_orden),N(t.detalle_orden),m(t),c(!0)},T=(t,s)=>{R(t,s).then(x=>{x.err?g.error(x.message):g.success(x.message)}).finally(()=>l())},q=(t,s)=>{G(t,s).then(x=>{x.err?g.error(x.message):g.success(x.message)}).finally(()=>l())};return e.jsxs("div",{className:"h-screen px-[5%] py-[5%]",children:[e.jsx("div",{className:"title-1 flex-between",children:e.jsx("span",{children:"ORDENES"})}),e.jsxs("div",{className:"flex-between",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex-center gap-5",children:[e.jsx(n.reload,{size:25,onClick:()=>l(),className:"cursor-pointer"}),e.jsx(I.Search,{onChange:O})," ",e.jsx("button",{onClick:()=>c(!0),children:e.jsx(n.add,{size:25,color:"white",className:"bg-[#1f2937] bg-hover-3 rounded-full"})})]}),e.jsx("div",{})]}),e.jsx(E,{className:"mt-5",dataSource:k,loading:d,rowKey:"id_orden",columns:[{title:"Orden",width:100,render:(t,s)=>e.jsx("div",{className:"bg-4 p-1 mx-auto text-xl text-1 rounded-lg flex-center items-center",children:e.jsx("strong",{children:s.id_orden})})},{title:"Nombre",width:250,render:(t,s)=>e.jsx("div",{className:"",children:e.jsx("strong",{children:s.titular})})},{title:"Para",render:(t,s)=>e.jsx("div",{className:"",children:e.jsx("strong",{children:parseInt(s.comer_aqui)===1?e.jsx(n.store,{size:30}):e.jsx(n.truck,{size:30})})})},{title:"Fecha",dataIndex:"fecha_ingreso",key:"fecha_ingreso"},{title:"Total",render:(t,s)=>e.jsxs("div",{className:"",children:["GTQ ",e.jsx("strong",{children:s.total})]})},{title:"Estado",render:(t,s)=>e.jsx("div",{className:"",children:e.jsx("strong",{className:`${parseInt(s.estado)===1?"bg-green-700 ":"bg-orange-400"} text-white p-1 rounded-md hover:border-2 border-[#00000059] cursor-pointer`,onClick:()=>q(s.id_orden,parseInt(s.estado)===1?0:1),children:parseInt(s.estado)===1?"Entregado":"Preparando"})})},{title:"Pagado",render:(t,s)=>e.jsx("div",{className:"",children:e.jsx("strong",{className:`${parseInt(s.pagado)===1?"text-green-700":"text-red-800"} `,children:e.jsx("div",{className:"cursor-pointer",onClick:()=>T(s.id_orden,parseInt(s.pagado)===1?0:1),children:parseInt(s.pagado)===1?e.jsx(n.check,{size:25}):e.jsx(n.cancel,{size:25})})})})},{title:"Editar",render:(t,s)=>e.jsx("strong",{className:"cursor-pointer",onClick:()=>p(s),children:e.jsx(n.edit,{className:"hover:text-gray-500 ",size:20})})}],pagination:{onChange:t=>y(t),pageSize:b,current:v,total:(o==null?void 0:o.length)||0}}),e.jsx(D,{open:j,footer:null,onCancel:()=>r(),title:e.jsxs("div",{children:[i?"Editar":"Crear"," Orden "]}),width:1200,centered:!0,children:e.jsx(Q,{data:i,onClose:()=>z()})})]})}export{V as default};
