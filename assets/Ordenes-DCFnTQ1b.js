import{r as n,A as T,O as M,P,j as e,I as i,i as q}from"./index-Dyw-6YHK.js";import{I as C,F as y,B as F,s as z}from"./index-DXXKSB0o.js";import{T as E,R as O,M as A}from"./Table-CumLv_PU.js";function L({data:a,onClose:l}){const{session:f}=n.useContext(T),{handleItemQuantity:h,isItemAdded:p,carrito:g,totalCarrito:o}=n.useContext(M),{menu:d}=n.useContext(P),[u,N]=n.useState(""),[v,j]=n.useState(1),x=5,_=(v-1)*x,w=_+x,m=n.useRef();m.current&&!a&&m.current.resetFields(),n.useEffect(()=>{m.current.resetFields()},[a]);const c=d.filter(s=>s.nombre_menu.toLowerCase().includes(u.toLowerCase())||s.precio.toLowerCase().includes(u.toLowerCase())),I=c==null?void 0:c.slice(_,w),S=async s=>{const k={...s,carrito:g,total:o,id_orden:a&&a.id_orden?a.id_orden:0,id_usuario:f.id_usuario};await q(k).then(b=>{b.err?z.error(b.message):z.success(b.message)}).finally(()=>l())};return e.jsx("div",{className:"mt-5 p-5 bg-white rounded-lg shadow-lg h-[675px] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-gray-600 text-xl block mb-2",children:"Menú"}),e.jsx(C,{type:"text",placeholder:"Buscar por nombre de menú",className:"mb-4 border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200",onChange:s=>N(s.target.value)}),e.jsx(E,{dataSource:I,rowKey:"id_menu_comida",columns:[{title:"No.",dataIndex:"id_menu_comida",key:"id_menu_comida"},{title:"Menu",dataIndex:"nombre_menu",key:"nombre_menu"},{title:"Precio",dataIndex:"precio",key:"precio"},{title:"Opcion",render:s=>e.jsxs("div",{className:"flex gap-5",children:[e.jsx("button",{className:"hover:bg-gray-800 rounded-full hover:text-white",onClick:()=>h(s.id_menu_comida,"add",d),children:e.jsx(i.add,{size:25})}),p(s.id_menu_comida)&&e.jsx("button",{className:"hover:bg-gray-800 rounded-full hover:text-white",onClick:()=>h(s.id_menu_comida,"delete",d),children:e.jsx(i.delete,{size:25})})]})}],pagination:{onChange:s=>j(s),pageSize:x,current:v,total:(d==null?void 0:d.length)||0}})]}),e.jsx("div",{children:e.jsxs(y,{layout:"vertical",ref:m,onFinish:S,initialValues:a&&{titular:a.titular,comer_aqui:parseInt(a.comer_aqui),direccion:a.direccion},children:[e.jsx(y.Item,{label:e.jsx("strong",{className:"text-gray-600 text-base block mb-2",children:"Nombre"}),name:"titular",rules:[{required:!0,message:"Ingrese Nombre"}],children:e.jsx(C,{className:"border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200"})}),e.jsx(y.Item,{name:"comer_aqui",rules:[{required:!0,message:"ingrese Opcion"}],children:e.jsxs(O.Group,{className:"flex-center gap-5 mb-4",children:[e.jsx(O,{value:1,children:e.jsx(i.store,{size:30})}),e.jsx(O,{value:0,children:e.jsx(i.truck,{size:30})})]})}),e.jsx(y.Item,{label:e.jsx("strong",{className:"text-gray-600 text-base block mb-2",children:"Dirección"}),name:"direccion",children:e.jsx(C.TextArea,{className:"border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200"})}),e.jsx("strong",{className:"text-gray-400",children:"Seleccionado"}),g.length>0&&e.jsxs("div",{className:"mt-5 p-4 border border-gray-200 rounded-lg shadow-sm bg-gray-50",children:[g.map(s=>e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("strong",{children:s.nombre_menu}),e.jsxs("span",{className:"bg-[#1f2937] text-white py-1 px-2 rounded-md ",children:["x",s.cantidad]})]}),e.jsxs("span",{children:["GTQ ",s.precio*s.cantidad]})]},s.id_menu_comida)),e.jsx("div",{className:"flex justify-end mt-3 bg-gray-100 p-2 rounded-md",children:e.jsxs("strong",{children:["Total: GTQ ",o]})})]}),e.jsx("div",{className:"flex-end mt-2",children:e.jsx(F,{className:"button-submit",type:"default",htmlType:"submit",children:"Guardar"})})]})})]})})}function Q(){const{loading:a,orden:l,setCarrito:f,getAll:h,calculateTotal:p}=n.useContext(M),[g,o]=n.useState(!1),[d,u]=n.useState(null),[N,v]=n.useState(1),j=10,x=(N-1)*j,_=x+j,[w,m]=n.useState(""),c=l&&l.filter(r=>r.titular.toLowerCase().includes(w.toLowerCase())),I=c==null?void 0:c.slice(x,_),S=r=>{m(r.target.value)},s=()=>{u(null),o(!1),f([]),p(0)},k=()=>{o(!1),u(null),h()},b=r=>{f(r.detalle_orden),p(r.detalle_orden),u(r),o(!0)};return e.jsxs("div",{className:"h-screen px-[5%] py-[5%]",children:[e.jsx("div",{className:"title-1 flex-between",children:e.jsx("span",{children:"ORDENES"})}),e.jsxs("div",{className:"flex-between",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex-center gap-5",children:[e.jsx(i.reload,{size:25,onClick:()=>h(),className:"cursor-pointer"}),e.jsx(C.Search,{onChange:S})," ",e.jsx("button",{onClick:()=>o(!0),children:e.jsx(i.add,{size:25,color:"white",className:"bg-[#1f2937] bg-hover-3 rounded-full"})})]}),e.jsx("div",{})]}),e.jsx(E,{className:"mt-5",dataSource:I,loading:a,rowKey:"id_orden",columns:[{title:"Orden",width:100,render:(r,t)=>e.jsx("div",{className:"bg-4 p-1 mx-auto text-xl text-1 rounded-lg flex-center items-center",children:e.jsx("strong",{children:t.id_orden})})},{title:"Nombre",width:250,render:(r,t)=>e.jsx("div",{className:"",children:e.jsx("strong",{children:t.titular})})},{title:"Para",render:(r,t)=>e.jsx("div",{className:"",children:e.jsx("strong",{children:parseInt(t.comer_aqui)===1?e.jsx(i.store,{size:30}):e.jsx(i.truck,{size:30})})})},{title:"Fecha",dataIndex:"fecha_ingreso",key:"fecha_ingreso"},{title:"Total",render:(r,t)=>e.jsxs("div",{className:"",children:["GTQ ",e.jsx("strong",{children:t.total})]})},{title:"Estado",render:(r,t)=>e.jsx("div",{className:"",children:e.jsx("strong",{className:`${parseInt(t.estado)===1?"text-green-700":"text-orange-400"} `,children:parseInt(t.comer_aqui)===1?"Entregado":"Preparando"})})},{title:"Editar",render:(r,t)=>e.jsx("strong",{className:"cursor-pointer",onClick:()=>b(t),children:e.jsx(i.edit,{className:"hover:text-gray-500 ",size:20})})}],pagination:{onChange:r=>v(r),pageSize:j,current:N,total:(l==null?void 0:l.length)||0}}),e.jsx(A,{open:g,footer:null,onCancel:()=>s(),title:e.jsxs("div",{children:[d?"Editar":"Crear"," Orden "]}),width:1200,centered:!0,children:e.jsx(L,{data:d,onClose:()=>k()})})]})}export{Q as default};
